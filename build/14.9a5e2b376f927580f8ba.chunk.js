(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"055911c3464d63c9d83c":function(e,t,n){"use strict";n.r(t);var a,i=n("8af190b70a6bc55c6f1b"),o=(n("8a2d1b95e05b6a321e74"),n("6938d226fd372a75cbf9")),r=n("39cd24fdebf6cbef88a3"),l=n("cba78edefe8c800ee17e");function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n,i){a||(a="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,r=arguments.length-3;if(t||0===r||(t={children:void 0}),t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});if(1===r)t.children=i;else if(r>1){for(var c=new Array(r),s=0;s<r;s++)c[s]=arguments[s+3];t.children=c}return{$$typeof:a,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){h(e,t,n[t])}))}return e}function d(e,t,n,a,i,o,r){try{var l=e[o](r),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(a,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function r(e){d(o,a,i,r,l,"next",e)}function l(e){d(o,a,i,r,l,"throw",e)}r(void 0)}))}}function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=s("div",{}),g=function(e){function t(e){var n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,i=m(t).call(this,e),n=!i||"object"!==c(i)&&"function"!==typeof i?b(a):i,h(b(n),"getSelectedIds",(function(e,t){var n=[];return e.forEach((function(e){t.filter((function(t){return t.id===e.id})).length>0&&n.push(""+e.id)})),n})),h(b(n),"createFormJson",f(regeneratorRuntime.mark((function e(){var t,a,i,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state,a=t.action,i=t.communities,o=t.ccActions,r=t.vendors,l={title:"Update Action",subTitle:"",method:"/actions.update",successRedirectPage:"/admin/edit/".concat(a.id,"/action"),fields:[{label:"About this Action",fieldType:"Section",children:[{name:"action_id",label:"Action ID (Do not Edit)",placeholder:"Use Heat Pumps",fieldType:"TextField",contentType:"text",isRequired:!0,defaultValue:a.id,dbName:"action_id",readOnly:!0},{name:"title",label:"Title of Action (Between 4 and 40 characters)",placeholder:"Use Heat Pumps",fieldType:"TextField",contentType:"text",isRequired:!0,defaultValue:a.title,dbName:"title",readOnly:!1},{name:"rank",label:"Rank (Which order should this action appear in?  Lower numbers come first)",placeholder:"eg. 1",fieldType:"TextField",contentType:"number",isRequired:!0,defaultValue:a.rank,dbName:"rank",readOnly:!1},{name:"is_global",label:"Is this Action a Template?",fieldType:"Radio",isRequired:!1,defaultValue:a.is_global?"true":"false",dbName:"is_global",readOnly:!1,data:[{id:"false",value:"No"},{id:"true",value:"Yes"}],child:{valueToCheck:"false",fields:[{name:"community",label:"Primary Community",placeholder:"eg. Wayland",fieldType:"Dropdown",defaultValue:a.community&&""+a.community.id,dbName:"community_id",data:i}]}},{name:"is_published",label:"Should this action go live?",fieldType:"Radio",isRequired:!1,defaultValue:a.is_published?"true":"false",dbName:"is_published",readOnly:!1,data:[{id:"false",value:"No"},{id:"true",value:"Yes"}]}]},{label:"Carbon Calculator - Link your Action to one of our Carbon Calculator Actions",fieldType:"Section",children:[{name:"calculator_action",label:"Calculator Action",placeholder:"eg. Wayland",fieldType:"Dropdown",defaultValue:a.calculator_action&&""+a.calculator_action.id,dbName:"calculator_action",data:o,modalTitle:"Carbon Action List & Instructions",modalText:"Check out the instructions here: https://docs.google.com/document/d/1RisvrGJQifCq9c62etcwR1YCUffExz_T8lR2XDGmokQ/edit"}]},{name:"featured_summary",label:"Featured Summary",placeholder:"eg. This event is happening in ...",fieldType:"TextField",isMulti:!0,isRequired:!1,defaultValue:a.featured_summary,dbName:"featured_summary"},{name:"about",label:"Write some detailed description about this action",placeholder:"eg. Write some detailed description about this action",fieldType:"HTMLField",isRequired:!0,defaultValue:a.about,dbName:"about"},{name:"steps_to_take",label:"Please outline steps to take for your users",placeholder:"eg. Please outline steps to take for your users",fieldType:"HTMLField",isRequired:!0,defaultValue:a.steps_to_take,dbName:"steps_to_take"},{name:"deep_dive",label:"Deep dive into all the details",placeholder:"eg. This action ...",fieldType:"HTMLField",isRequired:!0,defaultValue:a.deep_dive,dbName:"deep_dive"},{name:"vendors",label:"Select which vendors provide services for this action",placeholder:"eg. Solarize Wayland",fieldType:"Checkbox",selectMany:!0,defaultValue:a.vendors?a.vendors.map((function(e){return""+e.id})):[],dbName:"vendors",data:r},{name:"image",placeholder:"Select an Image",fieldType:"File",previewLink:a.image&&a.image.url,dbName:"image",label:"Upload Files",isRequired:!1,defaultValue:"",filesLimit:1}]},e.abrupt("return",l);case 3:case"end":return e.stop()}}),e)})))),n.state={communities:[],action:null,vendors:[],ccActions:[],formJson:null},n}var n,a,i,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:(o=f(regeneratorRuntime.mark((function e(){var t,n,a,i,o,l,c,s,d,f,p,m=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.next=3,Object(r.a)("/actions.info",{action_id:t});case 3:if(!(n=e.sent)||n.success){e.next=6;break}return e.abrupt("return");case 6:if(!n||!n.success){e.next=9;break}return e.next=9,this.setStateAsync({action:n.data});case 9:return e.next=11,Object(r.a)("/tag_collections.listForCommunityAdmin");case 11:return a=e.sent,e.next=14,Object(r.a)("/communities.listForCommunityAdmin");case 14:return i=e.sent,e.next=17,Object(r.a)("/vendors.listForCommunityAdmin");case 17:return o=e.sent,e.next=20,Object(r.a)("/cc/info/actions",{},null,!0);case 20:if(l=e.sent,!i||!i.data){e.next=25;break}return c=i.data.map((function(e){return u({},e,{displayName:e.name,id:""+e.id})})),e.next=25,this.setStateAsync({communities:c});case 25:if(!o||!o.data){e.next=29;break}return s=o.data.map((function(e){return u({},e,{displayName:e.name,id:""+e.id})})),e.next=29,this.setStateAsync({vendors:s});case 29:if(!(l&&l.data&&l.data.actions)){e.next=33;break}return d=(l.data.actions||[]).map((function(e){return u({},e,{displayName:e.description,id:""+e.id})})),e.next=33,this.setStateAsync({ccActions:d});case 33:return e.next=35,this.createFormJson();case 35:return f=e.sent,a&&a.data&&(p={label:"Please select tag(s) that apply to this action",fieldType:"Section",children:[]},Object.values(a.data).forEach((function(e){var t=m.state.action,n={name:e.name,label:"".concat(e.name," ").concat(e.allow_multiple?"(You can select multiple)":"(Only one selection allowed)"),placeholder:"",fieldType:"Checkbox",selectMany:e.allow_multiple,defaultValue:m.getSelectedIds(t.tags,e.tags),dbName:"tags",data:e.tags.map((function(e){return u({},e,{displayName:e.name,id:""+e.id})}))};p.children.push(n)})),f.fields.splice(1,0,p)),e.next=39,this.setStateAsync({formJson:f});case 39:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setStateAsync",value:function(e){var t=this;return new Promise((function(n){t.setState(e,n)}))}},{key:"render",value:function(){var e=this.props.classes,t=this.state.formJson;return t?s("div",{},void 0,s(l.a,{classes:e,formJson:t})):v}}])&&p(n.prototype,a),i&&p(n,i),t}(i.Component);t.default=Object(o.withStyles)((function(e){return{root:{flexGrow:1,padding:30},field:{width:"100%",marginBottom:20},fieldBasic:{width:"100%",marginBottom:20,marginTop:10},inlineWrap:{display:"flex",flexDirection:"row"},buttonInit:{margin:4*e.spacing.unit,textAlign:"center"}}}),{withTheme:!0})(g)}}]);